# Документация к API

Проект API созданный специально для выполнения тестового задания на стажировку VK Backend реализует возможность указанную в техническом задании.
Техническое задание можно просмотреть в файле Tasks.md
**Проект реализован на MySQL, dump можно найти в директории SchemaMySQL**
____

## Оглавнение

1. [Работа с API](#Работа-с-API)
    1. [Способ обращения](#Способ-обращения)
    2. [Общие параметры для любого запроса](#Общие-параметры-для-любого-запроса)
    3. [Тестовые токены](#Тестовые-токены)
2. [Методы](#Методы)
    1. [createComment](#createComment)
    2. [getCommentsByNumber](#getCommentsByNumber)
    3. [getCountryCode](#getCountryCode)
    4. [getNumbersByPattern](#getNumbersByPattern)
    5. [addRate](#addRate)
    6. [downRate](#downRate)
3. [Возвращаемые состояния и ошибки](#Возвращаемые-состояния-и-ошибки)

____

## Работа с API

### Способ обращения

Для обращений к нашему API используется следующий URL

```
    https://site.com/main.php (Никуда не заливал)
```

Все параметры принимаются <<- **`исключельно через POST`** | Все данные возвращаются в формате ->> **`JSON`**

### Общие параметры для любого запроса:

1. **method** (обязателен) - указывается название для метода.
2. **token** (не обязателен) - токен используемый для аутентификации пользователя, в случае отсутствия функционал сужается до анонимного пользователя. Токен должен быть размером в 32 символа.

### Тестовые токены:
1. (Имя: Misha)`364e569fdc48b433c95dda58009d3737`
2. (Имя: Olya) `2f2acef9e889e5d4245d89baee3afa6a`
3. (Имя: Igor) `be8e44a6f3fe7122a6dffd9b8fd066b0`
4. (Имя: Maks) `d41d8cd98f00b204e9800998ecf8427e`
5. (Имя: Viktor) `8d41627e46d5b8556d0d3e30ec15538e`

### Структура возвращаемого значения:

Каждый ответ возвращается в формате **json** следующей структуры

```json

[
	"response": [... Данные возвращаемые методом],
    "code": Код состояния
]

```

О состояних и ошибках вы можете узнать в [этом разделе](#Возвращаемые-состояния-и-ошибки)

____

## Методы

### createComment
Создание отзыва

**Параметры:**
1. number - Номер телефона
2. description - Текст отзыва

и [общие параметры](#Общие-параметры-для-любого-запроса)

**Возвращаемые значения:**
1. Объект отзыва:
    1. id - ID отзыва
    2. phoneNumber - Номер телефона
    3. description - Описание отзыва
    4. user - Автор отзыва
    5. rate - Рейтинг отзыва

### getCommentsByNumber
Получение объектов отзывов по номеру

**Параметры:**
1. number - Объект-номер телефона

и [общие параметры](#Общие-параметры-для-любого-запроса)

**Возвращаемые значения**
1. Объекты отзывов:
    1. id - ID отзыва
    2. phoneNumber - Номер телефона
    3. description - Описание отзыва
    4. user - Автор отзыва
    5. rate - Рейтинг отзыва

### getCountryCode
Получение кода региона номера телефона

**Параметры:**
1. number - номер телефона

и [общие параметры](#Общие-параметры-для-любого-запроса)

**Возвращаемые значения**
1. country - Код страны

### getNumbersByPattern
Получение списка объектов-номеров по их началу

**Параметры:**
1. pattern - начало номера телефона

и [общие параметры](#Общие-параметры-для-любого-запроса)

**Возвращаемые значения**
1. Объекты номеров:
    1. number - Номер
    2. country_code - Код страны
    3. comments_count - Количество отзывов о номере

### addRate
Повышение рейтинга отзыва
**Внимание:** Пользователь должен быть авторизован. Пользователь может оставить только одну реакцию на отзыв!

**Параметры:**
1. commentID - id отзыва

и [общие параметры](#Общие-параметры-для-любого-запроса)

**Возвращаемые значения**
1. Объект отзыва:
    1. id - ID отзыва
    2. phoneNumber - Номер телефона
    3. description - Описание отзыва
    4. user - Автор отзыва
    5. rate - Рейтинг отзыва

### downRate
Понижение рейтинга отзыва
**Внимание:** Пользователь должен быть авторизован. Пользователь может оставить только одну реакцию на отзыв!

**Параметры:**
1. commentID - id отзыва

и [общие параметры](#Общие-параметры-для-любого-запроса)

**Возвращаемые значения**
1. Объект отзыва:
    1. id - ID отзыва
    2. phoneNumber - Номер телефона
    3. description - Описание отзыва
    4. user - Автор отзыва
    5. rate - Рейтинг отзыва
____

## Возвращаемые состояния и ошибки

Список возможных возвратных кодов и сообщений об состоянии запроса или ошибках:


**Успех**:
```
0 - OK
```

**Ошибки**:
```
1 - Некорректный токен
2 - Некорректный номер
3 - Пустой параметр или его отсутствие
4 - Не указан метод или указан неверно
5 - Отсутствие входных данных
6 - Некорректный размер номера
7 - Неудачная попытка изменения рейтинга отзыва анонимным пользователем
8 - Неверный код международного 
9 - Пользователь уже поставил оценку на данный комментарий
```
